import base64
import json
import re

# stringsコマンドの出力から抽出した候補
candidates = [
    "eyJudCI6IndpZmkiLCJsdCI6Im5vcm1hbCIsImRtIjoiRFRIQTExNiIsIm1pZCI6InVmNzI0YmZjZGViYTk3Y2MxNjk2ZDk5MjM0ZGI1MDYxMiIsImx2IjoiMyIsInNpZCI6IjFlZWEyNjZiLTMwNTEtNDE1Mi05ZWNlLTQyM2IzYzk1NWM4MSIsImFkaWQiOiI2Mjg1MWM1Ni1mOGIzLTQ3Y2YtYTBmZC0zZjE5MmUyN2Q0ODkiLCJpZCI6ImxpbmVfYWN0aXZpdHkiLCJzbiI6ImNoYXR0YWIiLCJzY2lkIjoiOGYxZWVkMWUtYWU2Ny00OGM0LTgyMzctODViOTI2YmRlODhjIiwic3EiOjQwNCwib24iOiJBTkRST0lEIiwiYWIiOiIxNTE2MjAyMTYiLCJzdiI6IjQuOS4yIiwiYWUiOiJyZWxlYXNlIiwib3YiOiIxNCIsImFsIjpmYWxzZSwiYW4iOiJsaW5lIiwiZXQiOiJmb3JlZ3JvdW5kIiwiY3QiOjE3Njc1OTEzMjQxNTgsImF0IjoibmF0aXZlIiwiZXgiOnsiUEpTSE9QLTI3MTdfZm9sbG93X3VwX2VzYyI6IkMiLCJQSlNIT1AtOTExX3BfbWFya19yZW1vdmFsX2VzYyI6InRhcmdldCIsIkxJTkVQTEFOLTUxNzEyX09wZW5DaGF0X0FEX0dBRF9GQUxMQkFDS19KUCI6InRhcmdldCIsIlBKU0hPUC0xMDc5X2ltcHJvdmVfY29pbl9wdXJjaGFzZV9wYWdlX3JlYWwiOiJ0YXJnZXQiLCJVQy0zNDE2LUFORFJPSUQiOiJ0YXJnZXQiLCJMSU5FUExBTi04MDg2OF9BSV9GcmllbmRzX0VudHJ5IjoidGFyZ2V0IiwiVUMtOTU4M19leGNoYW5nZV9hbmRyb2lkX2xpYnJhcnlfZm9yX2FuaW1hdGlvbnNfZ3JhZHVhbF9yb2xsb3V0IjoidGFyZ2V0IiwiU01BUlRDSC0yNjY4X0xHRlBfSW50ZWdyYXRpb24tUmVhbCI6InRhcmdldCIsIlBKU0hPUC0zNjRfYnVkZHlfc3VnZ2VzdF9lc2MiOiJ0YXJnZXQiLCJMSU5FU0hPUC0yMjY1MV9lbmFibGVfc3RpY2tlcl9yZXNvdXJjZV91cmxfdmVyc2lvbl9wYXJhbWV0ZXIiOiJ0YXJnZXQifSwicmYiOiJzcGxhc2giLCJyZyI6IkpQIiwiYXYiOiIxNS4xNi4yIiwiZGlkIjoiNmNiYjhmYmYzMzMyMDQyZjg1NmJkYTdmODMwZTAyN2YiLCJkYiI6IldhY29tIiwiY2lkIjoiOTk4YzU3ODAtMDMxZi00OWY4LTgwMzYtZTZjOGRjMGQ2NDdiIn0=",
    "eyJudCI6IndpZmkiLCJsdCI6Im5vcm1hbCIsImRtIjoiRFRIQTExNiIsIm1pZCI6InVmNzI0YmZjZGViYTk3Y2MxNjk2ZDk5MjM0ZGI1MDYxMiIsImx2IjoiMyIsInNpZCI6IjFlZWEyNjZiLTMwNTEtNDE1Mi05ZWNlLTQyM2IzYzk1NWM4MSIsImFkaWQiOiI2Mjg1MWM1Ni1mOGIzLTQ3Y2YtYTBmZC0zZjE5MmUyN2Q0ODkiLCJpZCI6ImxpbmVfZ2VuZXJhbCIsInNuIjoic3BsYXNoIiwic2NpZCI6IjY4YTNjMTI5LTAwYzctNGYzZS05ZTdhLThjNThkNzJiYTAyNyIsInNxIjo0MDAsIm9uIjoiQU5EUk9JRCIsImFiIjoiMTUxNjIwMjE2Iiwic3YiOiI0LjkuMiIsImFlIjoicmVsZWFzZSIsIm92IjoiMTQiLCJhbCI6ZmFsc2UsImFuIjoibGluZSIsImV0IjoicGFnZXZpZXciLCJjdCI6MTc2NzU5MTE4MzExMCwiYXQiOiJuYXRpdmUiLCJleCI6eyJQSlNIT1AtMjcxN19mb2xsb3dfdXBfZXNjIjoiQyIsIlBKU0hPUC05MTFfcF9tYXJrX3JlbW92YWxfZXNjIjoidGFyZ2V0IiwiTElORVBMQU4tNTE3MTJfT3BlbkNoYXRfQURfR0FEX0ZBTExCQUNLX0pQIjoidGFyZ2V0IiwiUEpTSE9QLTEwNzlfaW1wcm92ZV9jb2luX3B1cmNoYXNlX3BhZ2VfcmVhbCI6InRhcmdldCIsIlVDLTM0MTYtQU5EUk9JRCI6InRhcmdldCIsIkxJTkVQTEFOLTgwODY4X0FJX0ZyaWVuZHNfRW50cnkiOiJ0YXJnZXQiLCJVQy05NTgzX2V4Y2hhbmdlX2FuZHJvaWRfbGlicmFyeV9mb3JfYW5pbWF0aW9uc19ncmFkdWFsX3JvbGxvdXQiOiJ0YXJnZXQiLCJTTUFSVENILTI2NjhfTEdGUF9JbnRlZ3JhdGlvbi1SZWFsIjoidGFyZ2V0IiwiUEpTSE9QLTM2NF9idWRkeV9zdWdnZXN0X2VzYyI6InRhcmdldCIsIkxJTkVTSE9QLTIyNjUxX2VuYWJsZV9zdGlja2VyX3Jlc291cmNlX3VybF92ZXJzaW9uX3BhcmFtZXRlciI6InRhcmdldCJ9LCJyZyI6IkpQIiwiYXYiOiIxNS4xNi4yIiwiZGlkIjoiNmNiYjhmYmYzMzMyMDQyZjg1NmJkYTdmODMwZTAyN2YiLCJkYiI6IldhY29tIiwiY2lkIjoiOTk4YzU3ODAtMDMxZi00OWY4LTgwMzYtZTZjOGRjMGQ2NDdiIn0=",
    "eyJudCI6IndpZmkiLCJsdCI6Im5vcm1hbCIsImRtIjoiRFRIQTExNiIsIm1pZCI6InVmNzI0YmZjZGViYTk3Y2MxNjk2ZDk5MjM0ZGI1MDYxMiIsImx2IjoiMyIsInNpZCI6IjFlZWEyNjZiLTMwNTEtNDE1Mi05ZWNlLTQyM2IzYzk1NWM4MSIsImFkaWQiOiI2Mjg1MWM1Ni1mOGIzLTQ3Y2YtYTBmZC0zZjE5MmUyN2Q0ODkiLCJpZCI6ImxpbmVfdGFiIiwic24iOiJjaGF0dGFiIiwic2NpZCI6IjhmMWVlZDFlLWFlNjctNDhjNC04MjM3LTg1YjkyNmJkZTg4YyIsImVjIjoibGF1bmNoIiwic3EiOjQwMywib24iOiJBTkRST0lEIiwiYWIiOiIxNTE2MjAyMTYiLCJzdiI6IjQuOS4yIiwiYWUiOiJyZWxlYXNlIiwib3YiOiIxNCIsImFsIjpmYWxzZSwiZXAiOnsiYmFkZ2UiOiJob21ldGFifGZhbHNlfDE3Njc1ODkwMjk1ODcsY2hhdHRhYnx0cnVlfDE3NjUzNjY1Nzc3MjgsdGltZWxpbmV8dHJ1ZXwxNzY3MjYwOTk4NDI5LG5ld3N0YWJ8dHJ1ZXwxNzYwOTc4NzU3ODY5LHdhbGxldHRhYnx0cnVlfDE3NjA5Nzg3NTc4MjkiLCJhY3Rpb24iOiJsYXVuY2gifSwiYW4iOiJsaW5lIiwiZXQiOiJjdXN0b20iLCJjdCI6MTc2NzU5MTIwMTg2NCwiYXQiOiJuYXRpdmUiLCJleCI6eyJQSlNIT1AtMjcxN19mb2xsb3dfdXBfZXNjIjoiQyIsIlBKU0hPUC05MTFfcF9tYXJrX3JlbW92YWxfZXNjIjoidGFyZ2V0IiwiTElORVBMQU4tNTE3MTJfT3BlbkNoYXRfQURfR0FEX0ZBTExCQUNLX0pQIjoidGFyZ2V0IiwiUEpTSE9QLTEwNzlfaW1wcm92ZV9jb2luX3B1cmNoYXNlX3BhZ2VfcmVhbCI6InRhcmdldCIsIlVDLTM0MTYtQU5EUk9JRCI6InRhcmdldCIsIkxJTkVQTEFOLTgwODY4X0FJX0ZyaWVuZHNfRW50cnkiOiJ0YXJnZXQiLCJVQy05NTgzX2V4Y2hhbmdlX2FuZHJvaWRfbGlicmFyeV9mb3JfYW5pbWF0aW9uc19ncmFkdWFsX3JvbGxvdXQiOiJ0YXJnZXQiLCJTTUFSVENILTI2NjhfTEdGUF9JbnRlZ3JhdGlvbi1SZWFsIjoidGFyZ2V0IiwiUEpTSE9QLTM2NF9idWRkeV9zdWdnZXN0X2VzYyI6InRhcmdldCIsIkxJTkVTSE9QLTIyNjUxX2VuYWJsZV9zdGlja2VyX3Jlc291cmNlX3VybF92ZXJzaW9uX3BhcmFtZXRlciI6InRhcmdldCJ9LCJyZiI6InNwbGFzaCIsInJnIjoiSlAiLCJhdiI6IjE1LjE2LjIiLCJkaWQiOiI2Y2JiOGZiZjMzMzIwNDJmODU2YmRhN2Y4MzBlMDI3ZiIsImRiIjoiV2Fjb20iLCJjaWQiOiI5OThjNTc4MC0wMzFmLTQ5ZjgtODAzNi1lNmM4ZGMwZDY0N2IifQ=="
]

print("=== JWT候補解析 ===")
for i, c in enumerate(candidates):
    print(f"\n[Candidate {i+1}]")
    try:
        # 末尾のゴミを除去
        c = re.sub(r'[^A-Za-z0-9+/=]+$', '', c)
        padding = 4 - len(c) % 4
        if padding != 4:
            c += '=' * padding

        decoded = base64.b64decode(c).decode('utf-8')
        try:
            data = json.loads(decoded)
            print("Status: ✅ JSON Valid")
            # 重要なキーがあるか確認
            keys = data.keys()
            print(f"Keys: {list(keys)}")
            if "mid" in data:
                print(f"MID: {data['mid']}")
            if "cid" in data:
                print(f"CID (ClientID): {data['cid']}")
            if "did" in data:
                print(f"DID: {data['did']}")

        except json.JSONDecodeError:
            print("Status: ⚠️ Not JSON (but valid Base64)")
            print(f"Decoded: {decoded[:100]}...")

    except Exception as e:
        print(f"Error: {e}")
